<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Student Management</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="card">
    <h2>Student Management System</h2>
    <div class="nav-buttons">
      <button onclick="location.href='home.html'">Add New Student</button>
      <button onclick="loadStudents()">Refresh List</button>
    </div>
    
    <div id="studentsList">
      <p>Loading students...</p>
    </div>
  </div>

  <script>
    async function loadStudents() {
      const studentsList = document.getElementById('studentsList');
      studentsList.innerHTML = '<p>Loading students...</p>';
      
      const res = await fetch('/students');
      const data = await res.json();
      
      if (data.success) {
        if (data.students.length === 0) {
          studentsList.innerHTML = '<p>No students found.</p>';
          return;
        }
        
        let html = '<h3>Student List</h3><div class="student-grid">';
        data.students.forEach(student => {
          html += `
            <div class="student-card">
              <strong>ID:</strong> ${student.student_id}<br>
              <strong>Name:</strong> ${student.name}<br>
              <strong>Email:</strong> ${student.email}<br>
              <strong>Course:</strong> ${student.course}<br>
              <strong>Semester:</strong> ${student.semester}<br>
              <div class="student-actions">
                <button onclick="editStudent('${student.student_id}')">Edit</button>
                <button onclick="deleteStudent('${student.student_id}')">Delete</button>
              </div>
            </div>
          `;
        });
        html += '</div>';
        studentsList.innerHTML = html;
      } else {
        studentsList.innerHTML = '<p>Error loading students</p>';
      }
    }

    async function deleteStudent(studentId) {
      if (!confirm('Are you sure you want to delete this student?')) return;
      
      const res = await fetch(`/delete-student/${studentId}`, {
        method: 'DELETE'
      });
      const data = await res.json();
      
      alert(data.message);
      if (data.success) {
        loadStudents();
      }
    }

    function editStudent(studentId) {
      // Implementation for edit functionality
      alert('Edit functionality for student: ' + studentId);
    }

    // Load students when page loads
    loadStudents();
  </script>
</body>
</html>